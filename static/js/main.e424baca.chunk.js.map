{"version":3,"sources":["dappnode-logo-only.png","dappNodeAnimation.gif","App.tsx","index.tsx"],"names":["module","exports","session","url","installPackageKwargsMixed","id","name","options","BYPASS_RESOLVER","App","useState","status","setStatus","mixedContentError","setMixedContentError","sessionOpen","setSessionOpen","a","updating","Error","call","then","JSON","parse","catch","e","message","args","error","res","success","console","useEffect","connection","autobahn","Connection","realm","onopen","_session","log","window","event","kwargs","subscribe","_0","data","clear","x","onclose","reason","details","open","className","href","src","logoAnimation","logo","alt","onClick","disabled","Boolean","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"qHAAAA,EAAOC,QAAU,0mF,oBCAjBD,EAAOC,QAAU,IAA0B,+C,8RCgBvCC,E,2IAVEC,G,OAAM,yCAGNC,EAA4B,CAChCC,GAAI,wBACJC,KAAM,wBACNC,QAAS,CAAEC,iBAAiB,IA2IfC,MA/Hf,WAAgB,IAAD,EACeC,mBAAiB,IADhC,mBACNC,EADM,KACEC,EADF,OAEqCF,oBAAS,GAF9C,mBAENG,EAFM,KAEaC,EAFb,OAGyBJ,oBAAS,GAHlC,mBAGNK,EAHM,KAGOC,EAHP,iDAuCb,4BAAAC,EAAA,0DACMN,EAAOO,SADb,6DAIIN,EAAU,CAAEM,SAAU,gBAEjBhB,EANT,sBAMwBiB,MAAM,uBAN9B,uBAQsBjB,EACfkB,KAhEmB,8CAgEO,GAAIhB,GAE9BiB,KAAKC,KAAKC,OACVC,OAAM,SAACC,GAEN,MAAMN,MAAMM,EAAEC,UAAYD,EAAEE,MAAQF,EAAEE,KAAK,GAAKF,EAAEE,KAAK,GAAKF,EAAEG,WAdtE,WAQUC,EARV,QAgBaC,QAhBb,uBAgB4BX,MAAMU,EAAIH,SAhBtC,QAkBId,EAAU,CAAEkB,SAAS,IAlBzB,kDAoBIC,QAAQH,MAAR,MACAhB,EAAU,CAAEgB,MAAO,KAAEF,UArBzB,2DAvCa,sBAgEb,OA3DAM,qBAAU,WACR,IAAMC,EAAa,IAAIC,IAASC,WAAW,CAAEhC,MAAKiC,MAvBxC,mBAyBVH,EAAWI,OAAS,SAAAC,GAClBxB,GAAqB,GACrBE,GAAe,GACfd,EAAUoC,EACVP,QAAQQ,IAAI,uBAAyBpC,EAAM,4BAG3CqC,OAAOpB,KAAO,SAACqB,GAAD,IAAQC,EAAR,uDAAiB,GAAjB,OAAwBJ,EAASlB,KAAKqB,EAAO,GAAIC,IAE/DJ,EAASK,UA3BU,oCA2BkB,SAACC,EAAD,GAAmB,IAChDL,EAD+C,EAAXM,KAEtCN,EAAIO,MAAOlC,GAAU,SAAAmC,GAAC,sBAAUA,EAAV,CAAa7B,SAAU,QAE/CN,GAAU,SAAAmC,GAAC,sBAAUA,EAAV,CAAa7B,SAAS,GAAD,OAAKqB,EAAIjC,KAAT,aAAkBiC,EAAIb,kBAK5DO,EAAWe,QAAU,SAACC,EAAQC,GAO5B,OANAnB,QAAQH,MAAM,mBAAoB,CAAEqB,SAAQC,YAC7B,gBAAXD,GAEFnC,GAAqB,GAEvBE,GAAe,IACR,GAGTiB,EAAWkB,SACV,IA4BD,6BACGtC,GACC,yBAAKuC,UAAU,QACb,+GAIA,6DACgC,IAC9B,uBAAGC,KAAK,yFAAR,UAGC,KACD,uBAAGA,KAAK,uEAAR,WAGC,KACD,uBAAGA,KAAK,gHAAR,UAEK,MAKX,yBACEC,IAAK3C,EAAOO,SAAWqC,IAAgBC,IACvCJ,UAAS,eACPzC,EAAOiB,MACH,QACAjB,EAAOmB,QACP,UACAnB,EAAOO,SACP,WACA,IAENuC,IAAI,SAGN,uBAAGL,UAAU,SAAb,0BAEEzC,EAAOmB,SACP,4BACE4B,QA3GK,2CA4GLC,SAAUC,QAAQjD,EAAOO,WAAaH,IAFxC,UAQF,6BACGJ,EAAOiB,MACN,uBAAGwB,UAAU,aAAazC,EAAOiB,OAC/BjB,EAAOmB,QACT,uBAAGsB,UAAU,OAAb,6BACEzC,EAAOO,SACT,uBAAGkC,UAAU,OAAOzC,EAAOO,UACzB,QC5IZ2C,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,U","file":"static/js/main.e424baca.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAABLCAMAAAAPkIrYAAAAt1BMVEVHcEw3vrI5vrI1vbI3vrIwvLIwvLIwvLI9v7IwvLIwvLIxvLIxvLIyvbIyvbIwvLIzvbIzvbI1vbIwvLIyvbIxvLIyvbIxvLI0vbIwvLI0vbIxvLIxvLI2vbI0vbIzvbIzvbI1vbI0vbIxvLIzvbI0vbI1vbIyvbIxvLI0vbIwvLIyvbIxvbIzvbIyvbI0vbIyvbIzvbIzvbI0vbIxvLIzvbIzvbIyvbI0vbIyvbIvvLIwvLIxvLLXViuvAAAAOnRSTlMABwQaCvf7/QL57czBnILmSFwf8XzWld8q9C274w42YEwRO9tWMRWH0UDrjLZ0qSOjZW5ExmpRryaQm6esvQAABnhJREFUWMOtWNeCsrwWlRIC0pSOYkVFAStYJuH9n+tQFRSdz/kPNzPDJIu9124r6XT+8WGXB9len1ad/8OzHEKEkK/R/x1qZGCUPXLvv2NZ6xwKQY/9ei+tKKP632OzwEIi8SUSuRHj+NCrbbvxBRQjfWvXVM/2mRPyYacHcyxz/iUUNSyM4Ac1w3YAIeycv3Ux6hZY9qT2UvFUGPa+Tom+XQZtWydnI3On7xNg45d29RvW+uDYtno13tzee766Fokp3Opvez7ot4S8d3UdXqPegs0FBiG8vtRdZPsqOL1+v5eHHBiz94Us8VCtpURaRBMeYv3l+6tdQYd/+ZCtfbXBFnmUcwaDp0Au3TJMwYccHrtQqv25F4o9cvTEhlNiGeR7LEVAB7oexGIPt20u28ft7xvP7JByf6MfxJf1qDWXERL3UiIv/WrBY6ari1EWudFY44tyROriqZ8EHMYYxNP3dM00OUnXIOweidXU0DnM5GBYPTfJ75k4Dn5Og/dsEacuwhkWQk5wlTFSBU30OcYG2DzV+xp1RfKF+FjvyzVCOMFJZgmDsLnrU+Rsqkn9rYl87zE/yC1ggs/lzp4zQpMkr6TEDaJ7UhOLNbKN/T0jdBS3kk6PJ5N5/hHCwKjwMIucV/8wG8WI25X7VwfsT9pIpzwTACdQOjQ1F1KbkhILPnXl5ZXBwpxNl1HHLhbb6pD28qYFDmdjaHIY3bHAUxayN9HG/KJnhKGL1+PWmikHDQcwggAmSYX1OhGpQMWOk8dFIj71UqzqV+kcZ0A4BURo9zr2Z1s5KRbvZp+wuGAwY9l+/tmMNH3TRshPabTz0cdiaNFHHSKEMXYvbRlNaiWWOm3NCA8UZhVpTY4DQdd9FO/fJ2BGZvu4pDwXADPNiSotlcFA4tT+28LIWLi+0VCjeZqrDRHRGeionV3inPUzyG/+fbgRP1iO2DbGlnoiC8H4G3EROTCUpOP4pX4nqr2lvtMDFo8hhLbuKU98iFhflr/erNW/mEeJoMy66+3JRSTSxag96G44adBMWL2N8gxPaCVUCvYzauQEKCdeoa78bY0ESuNlZ9inWyNfZHg9ZKMdWt/q6sp95NnoJzdA7jctO9oPLEarhXPsYIOoqxjmdN8ZycWrYYNiUoIPLFwJVcKaLgyunPmLqiM8vqQxZUk0co/0aljoUBBmebzs28hNV7LKOYYvqk8qsfxmrzrXfMSm16PIUgFhzAgb6xTbGL6oq6rhrJuDYO7WsBIsD7XFMNubYJzANQ8QFwchyGqpNmqVfAnC62bZ0+LdSRiHMkSczyQ475EpHALx1iKUs3jQlvUym4cqZrocHC6bZ6CqUSNhPNtIgp8alL7KsBD2NSWDYGn6qWD3E0/riwCFNbBlCG3egRhj+ZC9JqmTX46BzDR9+V69sR1F5FBq2WgQRYMROwghJw4iTRSl6apqvtXUTH+a44/1pxgADc8Ht9s1d+cQcWIqKcmaD4NaIaC19Vsx29guvAAQiMqLOsX3uL7pknXewooQhIf7lyOXkNxTxO//1mX2QvnlBCf83YnReHGxCGqrwwRW2SYov2EtSi2ZqRy1Ombsf1y7y3tXG/miKOdjmMPO5beDo1QRkonCoCjnmZhPMJgw8WQ2mxrCWjA0Ew33v2AFVdBTYrBR9LNp2ViAaGWlQq+UFUFrHNcqJqjL6ThO/8FS02Gl4NIf0CsWa1xL5StDZEYt4//qA1vfUstt6MBCDub6q4qU1tpFLg4eHp8HqhLmlnQFl0PQccrixSipIlXFg7ea+oSBADjGvq0TJ7grSNFCz/tT1gj4cZWheSLYWoMfwstd5+rKkP0pGwvYXfZEh7zwXCbtORmgYQHGDnY+BxypqR0G/KvnbADraindqcUQ8lJkACRUlvVO5/nTkJp2W05C1VHnPjjYhQ2ObIcy7Mqy1nuHNiyqoEN+qOupamfHHsrI3WTpVt1Q9YxmdC3RVH3++PBhWp5DMzBhsRWNSctxmtbymDFPqny2mSysWqMt7crA7KTLIaweWuplJbmAc4zbL1cw9/MxVZQiaj310OPJcfO5ibGWwTGHcrScSnXyobl/euYCl82wHlsf3X+7Q1tdi54TZinCVnVtbv6CVZ3Si9NwVMr+kPoLVqUHChk0kvJMdqd/omuqNi6GVifBcXc98k9YitC8SCOppTXr/O1hF+7zBd/fH+IiABD3v7+U/R8cyE1NRw9JhQAAAABJRU5ErkJggg==\"","module.exports = __webpack_public_path__ + \"static/media/dappNodeAnimation.e73c6e35.gif\";","import React, { useEffect, useState } from \"react\";\nimport autobahn from \"autobahn\";\nimport logo from \"./dappnode-logo-only.png\";\nimport logoAnimation from \"./dappNodeAnimation.gif\";\nimport \"./App.css\";\n\nconst url = \"ws://my.wamp.dnp.dappnode.eth:8080/ws\";\nconst realm = \"dappnode_admin\";\nconst installPackageRoute = \"installPackage.dappmanager.dnp.dappnode.eth\";\nconst installPackageKwargsMixed = {\n  id: \"core.dnp.dappnode.eth\",\n  name: \"core.dnp.dappnode.eth\",\n  options: { BYPASS_RESOLVER: true }\n};\nconst progressLogEvent = \"log.dappmanager.dnp.dappnode.eth\";\n\nlet session: autobahn.Session;\n\ninterface Status {\n  updating?: string;\n  error?: string;\n  success?: boolean;\n}\n\nfunction App() {\n  const [status, setStatus] = useState<Status>({});\n  const [mixedContentError, setMixedContentError] = useState(false);\n  const [sessionOpen, setSessionOpen] = useState(false);\n\n  useEffect(() => {\n    const connection = new autobahn.Connection({ url, realm });\n\n    connection.onopen = _session => {\n      setMixedContentError(false);\n      setSessionOpen(true);\n      session = _session;\n      console.log(\"CONNECTED to \\nurl: \" + url + \" \\nrealm: \" + realm);\n      // For testing:\n      // @ts-ignore\n      window.call = (event, kwargs = {}) => _session.call(event, [], kwargs);\n\n      _session.subscribe(progressLogEvent, (_0, { data }) => {\n        const log: { name: string; message: string; clear: boolean } = data;\n        if (log.clear) setStatus(x => ({ ...x, updating: \"\" }));\n        else\n          setStatus(x => ({ ...x, updating: `${log.name}: ${log.message}` }));\n      });\n    };\n\n    // connection closed, lost or unable to connect\n    connection.onclose = (reason, details) => {\n      console.error(\"CONNECTION_CLOSE\", { reason, details });\n      if (reason === \"unsupported\") {\n        // This error may be caused by mixed-content restrictions\n        setMixedContentError(true);\n      }\n      setSessionOpen(false);\n      return false;\n    };\n\n    connection.open();\n  }, []);\n\n  async function updateCore() {\n    if (status.updating) return;\n\n    try {\n      setStatus({ updating: \"Updating...\" });\n\n      if (!session) throw Error(\"Session is not open\");\n\n      const res = await session\n        .call(installPackageRoute, [], installPackageKwargsMixed)\n        // @ts-ignore\n        .then(JSON.parse)\n        .catch((e: any) => {\n          // crossbar return errors in a specific format\n          throw Error(e.message || (e.args && e.args[0] ? e.args[0] : e.error));\n        });\n      if (!res.success) throw Error(res.message);\n\n      setStatus({ success: true });\n    } catch (e) {\n      console.error(e);\n      setStatus({ error: e.message });\n    }\n  }\n\n  return (\n    <div>\n      {mixedContentError && (\n        <div className=\"card\">\n          <div>\n            You must allow mixed content to communicate with your DAppNode's\n            HTTP endpoint\n          </div>\n          <div>\n            How to allow mixed content in{\" \"}\n            <a href=\"https://stackoverflow.com/questions/18321032/how-to-get-chrome-to-allow-mixed-content\">\n              Chrome\n            </a>\n            {\", \"}\n            <a href=\"https://support.mozilla.org/en-US/kb/mixed-content-blocking-firefox\">\n              Firefox\n            </a>\n            {\", \"}\n            <a href=\"https://docs.adobe.com/content/help/en/target/using/experiences/vec/troubleshoot-composer/mixed-content.html\">\n              others\n            </a>{\" \"}\n          </div>\n        </div>\n      )}\n\n      <img\n        src={status.updating ? logoAnimation : logo}\n        className={`logo ${\n          status.error\n            ? \"error\"\n            : status.success\n            ? \"success\"\n            : status.updating\n            ? \"updating\"\n            : \"\"\n        }`}\n        alt=\"logo\"\n      />\n\n      <p className=\"title\">DAppNode core updater</p>\n\n      {!status.success && (\n        <button\n          onClick={updateCore}\n          disabled={Boolean(status.updating || !sessionOpen)}\n        >\n          UPDATE\n        </button>\n      )}\n\n      <div>\n        {status.error ? (\n          <p className=\"log error\">{status.error}</p>\n        ) : status.success ? (\n          <p className=\"log\">Successfully updated core</p>\n        ) : status.updating ? (\n          <p className=\"log\">{status.updating}</p>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}