{"version":3,"sources":["dappnode-logo-only.png","dappNodeAnimation.gif","App.tsx","index.tsx"],"names":["module","exports","session","url","installPackageKwargsMixed","id","name","options","BYPASS_RESOLVER","App","useState","status","setStatus","a","updating","Promise","r","setTimeout","Error","call","then","JSON","parse","catch","e","message","args","error","res","success","console","useEffect","connection","autobahn","Connection","realm","onopen","_session","log","window","event","kwargs","subscribe","_0","data","clear","x","onclose","reason","details","open","src","logoAnimation","logo","className","alt","onClick","disabled","Boolean","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"qHAAAA,EAAOC,QAAU,0mF,oBCAjBD,EAAOC,QAAU,IAA0B,+C,8RCgBvCC,E,4IAVEC,G,OAAM,yCAGNC,EAA4B,CAChCC,GAAI,wBACJC,KAAM,wBACNC,QAAS,CAAEC,iBAAiB,IAyGfC,MA7Ff,WAAgB,IAAD,EACeC,mBAAiB,IADhC,mBACNC,EADM,KACEC,EADF,iDA8Bb,4BAAAC,EAAA,0DACMF,EAAOG,SADb,6DAIIF,EAAU,CAAEE,SAAU,gBAEjBZ,EANT,gCAMwB,IAAIa,SAAQ,SAAAC,GAAC,OAAIC,WAAWD,EAAG,QANvD,UAOSd,EAPT,sBAOwBgB,MAAM,uBAP9B,wBASsBhB,EACfiB,KAxDmB,8CAwDO,GAAIf,GAE9BgB,KAAKC,KAAKC,OACVC,OAAM,SAACC,GAEN,MAAMN,MAAMM,EAAEC,UAAYD,EAAEE,MAAQF,EAAEE,KAAK,GAAKF,EAAEE,KAAK,GAAKF,EAAEG,WAftE,YASUC,EATV,QAiBaC,QAjBb,uBAiB4BX,MAAMU,EAAIH,SAjBtC,QAmBIb,EAAU,CAAEiB,SAAS,IAnBzB,kDAqBIC,QAAQH,MAAR,MACAf,EAAU,CAAEe,MAAO,KAAEF,UAtBzB,2DA9Ba,sBAwDb,OArDAM,qBAAU,WACR,IAAMC,EAAa,IAAIC,IAASC,WAAW,CAAE/B,MAAKgC,MArBxC,mBAuBVH,EAAWI,OAAS,SAAAC,GAClBnC,EAAUmC,EACVP,QAAQQ,IAAI,uBAAyBnC,EAAM,4BAG3CoC,OAAOpB,KAAO,SAACqB,GAAD,IAAQC,EAAR,uDAAiB,GAAjB,OAAwBJ,EAASlB,KAAKqB,EAAO,GAAIC,IAE/DJ,EAASK,UAvBU,oCAuBkB,SAACC,EAAD,GAAmB,IAChDL,EAD+C,EAAXM,KAEtCN,EAAIO,MAAOjC,GAAU,SAAAkC,GAAC,sBAAUA,EAAV,CAAahC,SAAU,QAE/CF,GAAU,SAAAkC,GAAC,sBAAUA,EAAV,CAAahC,SAAS,GAAD,OAAKwB,EAAIhC,KAAT,aAAkBgC,EAAIb,kBAK5DO,EAAWe,QAAU,SAACC,EAAQC,GAE5B,OADAnB,QAAQH,MAAM,mBAAoB,CAAEqB,SAAQC,aACrC,GAGTjB,EAAWkB,SACV,IA6BD,6BACE,yBACEC,IAAKxC,EAAOG,SAAWsC,IAAgBC,IACvCC,UAAS,eACP3C,EAAOgB,MACH,QACAhB,EAAOkB,QACP,UACAlB,EAAOG,SACP,WACA,IAENyC,IAAI,SAGN,uBAAGD,UAAU,SAAb,0BAEE3C,EAAOkB,SACP,4BAAQ2B,QA3ED,2CA2EsBC,SAAUC,QAAQ/C,EAAOG,WAAtD,UAKF,6BACGH,EAAOgB,MACN,uBAAG2B,UAAU,aAAa3C,EAAOgB,OAC/BhB,EAAOkB,QACT,uBAAGyB,UAAU,OAAb,6BACE3C,EAAOG,SACT,uBAAGwC,UAAU,OAAO3C,EAAOG,UACzB,QC1GZ6C,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,U","file":"static/js/main.a3ba18b0.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/dappNodeAnimation.e73c6e35.gif\";","import React, { useEffect, useState } from \"react\";\nimport autobahn from \"autobahn\";\nimport logo from \"./dappnode-logo-only.png\";\nimport logoAnimation from \"./dappNodeAnimation.gif\";\nimport \"./App.css\";\n\nconst url = \"ws://my.wamp.dnp.dappnode.eth:8080/ws\";\nconst realm = \"dappnode_admin\";\nconst installPackageRoute = \"installPackage.dappmanager.dnp.dappnode.eth\";\nconst installPackageKwargsMixed = {\n  id: \"core.dnp.dappnode.eth\",\n  name: \"core.dnp.dappnode.eth\",\n  options: { BYPASS_RESOLVER: true }\n};\nconst progressLogEvent = \"log.dappmanager.dnp.dappnode.eth\";\n\nlet session: autobahn.Session;\n\ninterface Status {\n  updating?: string;\n  error?: string;\n  success?: boolean;\n}\n\nfunction App() {\n  const [status, setStatus] = useState<Status>({});\n\n  useEffect(() => {\n    const connection = new autobahn.Connection({ url, realm });\n\n    connection.onopen = _session => {\n      session = _session;\n      console.log(\"CONNECTED to \\nurl: \" + url + \" \\nrealm: \" + realm);\n      // For testing:\n      // @ts-ignore\n      window.call = (event, kwargs = {}) => _session.call(event, [], kwargs);\n\n      _session.subscribe(progressLogEvent, (_0, { data }) => {\n        const log: { name: string; message: string; clear: boolean } = data;\n        if (log.clear) setStatus(x => ({ ...x, updating: \"\" }));\n        else\n          setStatus(x => ({ ...x, updating: `${log.name}: ${log.message}` }));\n      });\n    };\n\n    // connection closed, lost or unable to connect\n    connection.onclose = (reason, details) => {\n      console.error(\"CONNECTION_CLOSE\", { reason, details });\n      return false;\n    };\n\n    connection.open();\n  }, []);\n\n  async function updateCore() {\n    if (status.updating) return;\n\n    try {\n      setStatus({ updating: \"Updating...\" });\n\n      if (!session) await new Promise(r => setTimeout(r, 3000));\n      if (!session) throw Error(\"Session is not open\");\n\n      const res = await session\n        .call(installPackageRoute, [], installPackageKwargsMixed)\n        // @ts-ignore\n        .then(JSON.parse)\n        .catch((e: any) => {\n          // crossbar return errors in a specific format\n          throw Error(e.message || (e.args && e.args[0] ? e.args[0] : e.error));\n        });\n      if (!res.success) throw Error(res.message);\n\n      setStatus({ success: true });\n    } catch (e) {\n      console.error(e);\n      setStatus({ error: e.message });\n    }\n  }\n\n  return (\n    <div>\n      <img\n        src={status.updating ? logoAnimation : logo}\n        className={`logo ${\n          status.error\n            ? \"error\"\n            : status.success\n            ? \"success\"\n            : status.updating\n            ? \"updating\"\n            : \"\"\n        }`}\n        alt=\"logo\"\n      />\n\n      <p className=\"title\">DAppNode core updater</p>\n\n      {!status.success && (\n        <button onClick={updateCore} disabled={Boolean(status.updating)}>\n          UPDATE\n        </button>\n      )}\n\n      <div>\n        {status.error ? (\n          <p className=\"log error\">{status.error}</p>\n        ) : status.success ? (\n          <p className=\"log\">Successfully updated core</p>\n        ) : status.updating ? (\n          <p className=\"log\">{status.updating}</p>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}